{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Homepage","text":""},{"location":"#introduction","title":"Introduction","text":"<p>This repository contains code to help with general Gaia data handling and to perform a Bayesian analysis of the kinematics of stars in the Milky Way as described in A Bayesian Estimation of the Milky Way\u2019s Circular Velocity Curve using Gaia DR3 (P\u00f5der, Benito et al. 2023).</p> <p>The code is all written in python3 and makes substantial use of the standard pandas, numpy, matplotlib, etc. Additional libraries that you may need to investigate depending on your installation:</p> <ul> <li>astropy</li> <li>emcee</li> <li>lmfit</li> <li>corner</li> <li>h5py</li> <li>numba</li> </ul> <p>The input data used in the paper can be found on Zenodo.</p> <p>All Gaia parameters can be found here. </p>"},{"location":"#a-brief-summary-of-gaia","title":"A brief summary of Gaia","text":"<p>The Gaia Space Telescope was launched in December of 2013 and reached its planned orbit, at the L2 Lagrange Point about 1.5 million km from the Earth, within three weeks.  The Gaia mission is lead by the European Space Agency (ESA) and its main goal is to map the most accurate and voluminous three-dimensional map of our Galaxy.  The spacecraft itself is designed to maximise the accuracy, sensitivity, dynamic range and sky coverage to a level which has not yet been achieved. </p> <p>Gaia's structure consists of three modules: a payload module, which contains all the necessary instruments for the observation and data processing side of the mission, a mechanical service module and an electrical service module, both of which are keeping the spacecraft operational and have for example a thermal tent, sunshield, solar arrays etc.  Observations are based on spectra and take place in the range of 320 - 1000 nm.</p> <p>The data of the stars is measured by five astrometric parameters: two angular position coordinates, two proper motions components and the trigonometric parallax.  Furthermore, the radial-velocity spectrometer (RVS), measures the radial velocities of the stellar objects through Doppler-shifts using cross-correlation for stars brighter than G = 16 mag.</p>"},{"location":"#what-does-this-documentation-contain","title":"What does this Documentation contain?","text":"<p>The first topic of this Documentation is 'Galactocentric_transformation' which basically means transforming the data we get from the Gaia DR3 to other coordinate systems, in this case from ICRS to Galactocentric Cartesian and then to the Galactocentric Cylindrical coordinate system.</p> <p>In 'Error propagation' we transform to the same coordinate systems as previously, but now with the error ranges of the coordinates and velocities. </p> <p>And lastly 'CPU,GPU Optimization' ...</p>"},{"location":"CPU%2CGPU%20Optimization/","title":"CPU,GPU Optimization","text":"<p>[DOCUMENTATION UNDER CONSTRUCTION]</p>"},{"location":"Error_propagation/","title":"Error propagation","text":""},{"location":"Error_propagation/#covariance-data-processing","title":"Covariance data processing","text":"<p>A covariance matrix is a 6x6 matrix in the celestial frame from the dataframe of Gaia data. The parameter's columns used in this Pandas dataframe are: 'ra', 'dec', 'parallax, 'pmra', 'pmdec', and 'radial_velocity'. You should also have all the columns ending with '_error' for each of the parameters named before and columns ending with '_corr' for pairs that are correlated.</p> <p>In the Gaia-Tools code base under 'covmatrices_generation' the 'generate_covmat' function is used to create the covariance matrices and the function 'generate_covmatrices' can be used to transform the matrices from one coordinate system to another.</p>"},{"location":"Error_propagation/#covariance-data-propagation","title":"Covariance data propagation","text":"<p>Transforming the covariance matrix from ICRS to Galactocentric.</p> <p>Here's an example: <pre><code>data_icrs=pd.read_csv(path)\nfrom covariance_generation import generate_covmatrices, generate_covmat\nfrom data_analysis import get_transformed_data\ndf_new=get_transformed_data(data_icrs, z_0=25, r_0=8277, is_bayes=False)\ngenerate_covmatrices(data_icrs,\n                         df_crt = df_new,\n                         transform_to_galcen = True,\n                         transform_to_cylindrical = False,\n                         z_0 = 25,\n                         r_0 = 8277,\n                         is_bayes = False,\n                         is_unpack_velocity = False,\n                         debug = False)\n</code></pre></p> <p>Now we can transform the covariance matrix from Galactocentric \\(v_x\\), \\(v_y\\), \\(v_z\\) to Galactocentric \\(v_r\\), \\(v_\\varphi\\), \\(v_z\\).</p> <p>For example: <pre><code>data_icrs=pd.read_csv(path)\nfrom covariance_generation import generate_covmatrices, generate_covmat\nfrom data_analysis import get_transformed_data\ndf_new=get_transformed_data(data_icrs, z_0=25, r_0=8277, include_cylindrical=True, is_bayes=False)\ngenerate_covmatrices(data_icrs,\n                         df_crt = df_new,\n                         transform_to_galcen = True,\n                         transform_to_cylindrical = True,\n                         z_0 = 25,\n                         r_0 = 8277,\n                         is_bayes = False,\n                         is_unpack_velocity = False,\n                         debug = False)\n</code></pre></p> <p></p> <p></p>"},{"location":"Galactocentric_transformation/","title":"Galactocentric transformation","text":"<p>Gaia data is provided in the ICRS (International Celestial Reference System) frame. To study Milky Way dynamics, it is often necessary to convert this data to a Galactocentric reference frame.</p> <p>To transform both the position and velocity of a star, we need its 6D phase space information, defined by:  - right ascension: \\(\\alpha\\) [deg], - declination: \\(\\delta\\) [deg] - parallax or other distance measure: \\(\\varpi\\) [mas] / \\(d\\) [pc] - proper motion in \\(\\alpha\\): \\(\\mu_\\alpha\\) [mas/year] - proper motion in \\(\\delta\\): \\(\\mu_\\delta\\) [mas/year] - radial velocity: \\(v_r\\) [km/s]. </p> <p>The idea is to transform these parameters to a Galactrocentric frame of reference and Cartesian coordinates: \\(x\\), \\(y\\), \\(z\\), \\(v_x\\), \\(v_y\\), \\(v_z\\). After this, the switch to Galactocentric Cylindrical coordinates is straight forward: \\(r\\), \\(\\varphi\\), \\(z\\), \\(v_r\\), \\(v_\\varphi\\), \\(v_z\\).</p> <p>The exact column names of these data products in the Gaia data can be found here. </p>"},{"location":"Galactocentric_transformation/#positional-observables","title":"Positional observables","text":"<p>Transforming ICRS coordinates \\(\\alpha\\), \\(\\delta\\), \\(\\varpi\\) to Galactocentric Cartesian coordinates x, y, z.</p> \\[ \\textbf{r}_{ICRS} = \\begin{bmatrix}  x_{ICRS}\\\\  y_{ICRS}\\\\  z_{ICRS} \\end{bmatrix} = \\frac{k_1}{\\varpi} \\begin{bmatrix} \\cos(\\alpha) \\cos(\\delta)\\\\  \\sin(\\alpha) \\cos(\\delta)\\\\ \\sin(\\delta) \\end{bmatrix} \\] <p>(1)</p> <p>where \\(k_1=10^3\\) [pc] is a scaling factor and \\(\\varpi\\) [mas] is the measured annual parallax of the star.</p> \\[ \\begin{bmatrix}  x\\\\  y\\\\  z\\\\ \\end{bmatrix}=\\textbf{H}\\begin{pmatrix} \\textbf{A}_G^T \\begin{bmatrix} x_{ICRS}\\\\  y_{ICRS}\\\\  z_{ICRS}\\\\  \\end{bmatrix} -R_0 \\begin{bmatrix} 1\\\\ 0\\\\ 0\\\\ \\end{bmatrix} \\end{pmatrix} \\] <p>(2)</p> <p>Matrix \\(\\textbf{H}\\) accounts for the Sun's height over the Galactic plane, defined as:</p> \\[ \\textbf{H}=\\begin{bmatrix} cos(\\theta) &amp; 0 &amp; sin(\\theta)\\\\ 0 &amp; 1 &amp; 0\\\\ -sin(\\theta) &amp; 0 &amp; cos(\\theta) \\end{bmatrix} \\] <p>(3)</p> <p>where \\(\\theta\\) is the angle between the position vector of the Sun and the Galactic plane \\(\\theta=sin^{\u22121} (\\frac{z_0}{R_0})\\).</p> <p>The matrix \\(\\textbf{A}_G^T\\) is a 3x3 fixed orthogonal matrix, which is responsible for the rotation of the coordinate frame and is defined as:</p> \\[ \\textbf{A}_G^T= \\begin{bmatrix} \u22120.0548755604162154 &amp; \u22120.8734370902348850 &amp; \u22120.4838350155487132\\\\ 0.4941094278755837 &amp; \u22120.4448296299600112 &amp; 0.7469822444972189\\\\ \u22120.8676661490190047 &amp; \u22120.1980763734312015 &amp; 0.4559837761750669 \\end{bmatrix} \\] <p>(4)</p> <p>Here's an example: <pre><code>from data_analysis import get_transformed_data\ndf=pd.read_csv(path)\ndf_new=get_transformed_data(df,\n                        include_cylindrical = False,\n                        z_0 = 17,\n                        r_0 = 8178,\n                        v_sun = ([[11.1], [232.24], [7.25]])\n                        is_bayes = False,\n                        is_output_frame = False,\n                        is_source_included = False,\n                        NUMPY_LIB = np,\n                        dtype = np.float64)\n</code></pre></p> <p>ICRS and Galactrocentric Cartesian:</p> <p> </p> <p>An important argument in the above example is the 'is_bayes' flag. If True, the function will search for distance estimates using the column name 'r_est', expecting all distances to be in units of [pc]. If False, the function will use the inverse parallax as the distance estimates. </p> <p>Now we can transform the Galactocentric Cartesian coordinates x, y, z to Galactocentric Cylindrical coordinates r, \\(\\varphi\\), z. The only difference from the previous example is the flag 'include_cylindrical = True'.</p> <p>Here's an example: <pre><code>from data_analysis import get_transformed_data\ndf=pd.read_csv(path)\ndf_new=get_transformed_data(df,\n                        include_cylindrical = True,\n                        z_0 = 17,\n                        r_0 = 8178,\n                        v_sun = ([[11.1], [232.24], [7.25]])\n                        is_bayes = False,\n                        is_output_frame = False,\n                        is_source_included = False,\n                        NUMPY_LIB = np,\n                        dtype = np.float64)\n</code></pre> Galactocentric Cylindrical:</p> <p>This graph shows the distance of the stars from the Galactic center.</p> <p></p> <p>And this one shows the location of the stars relative to the Galactic disk.</p> <p></p>"},{"location":"Galactocentric_transformation/#velocities","title":"Velocities","text":"<p>Transforming the velocities to Galactocentric Cartesian, using the right ascension and declination proper motion components \\(\\begin{pmatrix} \\mu_\\alpha , \\mu_\\delta \\end{pmatrix}\\) as well as the radial velocity \\(\\begin{pmatrix} v_r \\end{pmatrix}\\):</p> \\[ \\begin{bmatrix} v_x\\\\ v_y\\\\ v_z \\end{bmatrix}=\\textbf{H}\\textbf{A}_G^T\\textbf{B} \\begin{bmatrix} v_r\\\\  \\frac{k_2}{\\varpi}{\\mu_\\alpha*}\\\\  \\frac{k_2}{\\varpi}\\mu_\\delta \\end{bmatrix} + \\begin{bmatrix} U_\\odot\\\\ V_{\\odot,TOT}\\\\ W_\\odot \\end{bmatrix} \\] <p>(5)</p> <p>where the scaling factor \\(k_2=4.74047\\) [pc] and the \\(\\textbf{B}\\) matrix is a coordinate matrix dependent on the right ascension and declination of the star, defined as:</p> \\[ \\textbf{B}=\\begin{bmatrix} cos(\\alpha) &amp; -sin(\\alpha) &amp; 0\\\\ sin(\\alpha) &amp; cos(\\alpha) &amp; 0\\\\ 0 &amp; 0 &amp; 1 \\end{bmatrix}\\begin{bmatrix} cos(\\delta) &amp; 0 &amp; -sin(\\delta)\\\\ 0 &amp; 1 &amp; 0\\\\ sin(\\delta) &amp; 0 &amp; cos(\\delta) \\end{bmatrix} \\] <p>(6)</p> <p>Here's and example of how to transform ICRS velocities to Galactocentric Cartesian velocities: <pre><code>from data_analysis import get_transformed_data\ndf=pd.read_csv(path)\ndf_new=get_transformed_data(df,\n                        include_cylindrical = False,\n                        z_0 = 17,\n                        r_0 = 8178,\n                        v_sun = ([[11.1], [232.24], [7.25]])\n                        is_bayes = False,\n                        is_output_frame = False,\n                        is_source_included = False,\n                        NUMPY_LIB = np,\n                        dtype = np.float64)\n</code></pre> Galactocentric Cartesian:</p> <p></p> <p>Now we can transform the Galactocentric Cartesian velocities to Galactocentric Cylindrical velocities.</p> <p>Here's an example: <pre><code>from data_analysis import get_transformed_data\ndf=pd.read_csv(path)\ndf_new=get_transformed_data(df,\n                        include_cylindrical = True,\n                        z_0 = 17,\n                        r_0 = 8178,\n                        v_sun = ([[11.1], [232.24], [7.25]])\n                        is_bayes = False,\n                        is_output_frame = False,\n                        is_source_included = False,\n                        NUMPY_LIB = np,\n                        dtype = np.float64)\n</code></pre> Galactocentric Cylindrical:</p> <p></p>"},{"location":"Galactocentric_transformation/#references","title":"References","text":"<p>(1)(2)(3) D. Hobbs et al. Gaia DR2 documentation Chapter 3: Astrometry. Gaia DR2 documentation. July 2018</p> <p>(4) D. Hobbs et al.Gaia DR2 documentation Chapter 2: Astrometric and photometric pre-processing. Gaia DR2 documentation. July 2018.</p> <p>(5) P. Schneider. Extragalactic Astronomy and Cosmology. Springer, 2015.</p>"}]}